<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, minimal-ui, viewport-fit=cover, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"
    />
    <title>Three-Noise | Examples</title>
    <link href="main.css" rel="stylesheet" />
  </head>
  <body>
    <div class="Side">
      <a class="Title" href="https://github.com/FarazzShaikh/glNoise">
        <img src="../Assets/logo.png" />
        gl-Noise
      </a>
      <div class="SubTitle">Examples</div>

      <a class="Section" selected="true" href="./Map/map.html"
        >2D Noise | Maps</a
      >
      <div class="Example" sec="map" selected="true" type="0">Perlin Noise</div>
      <div class="Example" sec="map" selected="false" type="1">
        Simplex Noise
      </div>
      <div class="Example" sec="map" selected="false" type="2">
        Perlin Noise (fBm)
      </div>
      <div class="Example" sec="map" selected="false" type="3">
        Simplex Noise (fBm)
      </div>
      <div class="Example" sec="map" selected="false" type="4">Ridge Noise</div>
      <div class="Example" sec="map" selected="false" type="5">
        Voronoi Noise
      </div>
      <div class="Example" sec="map" selected="false" type="6">
        Voronoi Noise (inverted)
      </div>

      <a class="Section" selected="false" href="./Plane/plane.html"
        >2D Noise | Plane</a
      >
      <div class="Example" sec="plane" selected="false" type="0">
        Perlin Noise
      </div>
      <div class="Example" sec="plane" selected="false" type="1">
        Simplex Noise
      </div>
      <div class="Example" sec="plane" selected="false" type="2">
        Perlin Noise (fBm)
      </div>
      <div class="Example" sec="plane" selected="false" type="3">
        Simplex Noise (fBm)
      </div>
      <div class="Example" sec="plane" selected="false" type="4">
        Ridge Noise
      </div>
      <div class="Example" sec="plane" selected="false" type="5">
        Voronoi Noise
      </div>
      <div class="Example" sec="plane" selected="false" type="6">
        Voronoi Noise (inverted)
      </div>

      <a class="Section" selected="false" href="./3D/3D.html">3D Noise</a>
      <div class="Example" sec="3d" selected="false" type="0">Perlin Noise</div>
      <div class="Example" sec="3d" selected="false" type="1">
        Simplex Noise
      </div>
      <div class="Example" sec="3d" selected="false" type="2">
        Perlin Noise (fBm)
      </div>
      <div class="Example" sec="3d" selected="false" type="3">
        Simplex Noise (fBm)
      </div>
      <div class="Example" sec="3d" selected="false" type="4">Ridge Noise</div>
      <div class="Example" sec="3d" selected="false" type="5">
        Voronoi Noise
      </div>
      <div class="Example" sec="3d" selected="false" type="6">
        Voronoi Noise (inverted)
      </div>
    </div>

    <iframe class="Iframe" allow="autoplay" src=""></iframe>

    <a class="SideIcon">&lt;</a>
    <a class="CodeIcon" href="" target="_blank">&lt;&#47;&gt;</a>

    <script>
      const sourceLink = document.querySelector(".CodeIcon");
      const toggleLink = document.querySelector(".SideIcon");
      const exampleLinks = document.querySelectorAll("a.Section");
      const exampleTabs = document.querySelectorAll(".Example");
      const iFrame = document.querySelector(".Iframe");
      const sourcePath =
        "https://github.com/FarazzShaikh/glNoise/tree/master/examples/";

      toggleLink.addEventListener("click", (e) => {
        e.preventDefault();
        document.body.toggleAttribute("data-hideSidebar");
      });

      // Load query example in iFrame if linked
      let loadQuery = location.search.split("src=");
      if (loadQuery[1]) {
        iFrame.src = loadQuery[1];
        sourceLink.href = sourcePath + loadQuery[1];
      } else {
        // choose random example to show if none linked
        let target =
          exampleLinks[Math.floor(Math.random() * exampleLinks.length)];
        updateExample({ target });
      }

      exampleLinks.forEach((link) => {
        link.addEventListener("click", updateExample, false);
      });

      exampleTabs.forEach((link) => {
        link.addEventListener("click", updateTab, false);
      });

      function updateTab(e) {
        const type = e.target.getAttribute("type");
        exampleTabs.forEach((e) => e.setAttribute("selected", "false"));
        e.target.setAttribute("selected", "true");

        localStorage.setItem("type", type);

        let index = 0;
        exampleTabs.forEach((e, i) => {
          if (e.getAttribute("selected") === "true") {
            index = i;
            return;
          }
        });

        switch (e.target.getAttribute("sec")) {
          case "map":
            if (exampleLinks[0].getAttribute("selected") === "false")
              exampleLinks[0].click();
            break;

          case "plane":
            if (exampleLinks[1].getAttribute("selected") === "false")
              exampleLinks[1].click();
            break;

          case "3d":
            if (exampleLinks[2].getAttribute("selected") === "false")
              exampleLinks[2].click();
            break;

          default:
            break;
        }
      }

      function updateExample(e) {
        let src = e.target.href.split("examples/")[1];
        exampleLinks.forEach((e) => e.setAttribute("selected", "false"));
        e.target.setAttribute("selected", "true");

        // Allow user to cmd/ctrl + click to open in new tab
        if (e.metaKey) {
          window.open(
            `${location.origin}${location.pathname}?src=${src}`,
            "_blank"
          );
          return;
        }

        iFrame.src = e.target.href;
        sourceLink.href = sourcePath + src;

        // Update search query
        history.pushState(
          null,
          null,
          `${location.origin}${location.pathname}?src=${src}`
        );
        e.preventDefault && e.preventDefault();
      }
    </script>
  </body>
</html>
